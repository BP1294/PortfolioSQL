Q1.  4 Marks

Display staff name, part number, part description of sales that included items located in New York.

a.	Using standard syntax

SELECT CONCAT(s.lastname,', ',s.firstname) 'Staff Name', i.partno 'Part Number', i.descript 'Part Description'
FROM staff s, inventory i
WHERE s.location = i.location
AND i.location = 'NEW YORK';


b.	Using syntax 1999

SELECT CONCAT(s.lastname,', ',s.firstname) 'Staff Name', i.partno 'Part Number', i.descript 'Part Description'
FROM staff s
JOIN inventory i
	ON s.location = i.location
WHERE i.location = 'NEW YORK';
 


Q2.  4 Marks

Which items are part of order number 020011? 
Display item name, and sale price

a.	Using standard syntax

SELECT a.descript 'Item Name', a.saleprice 'Sale Price'
FROM inventory a, items b
WHERE a.partno = b.partno
AND b.orderno = '020011';


b.	Using syntax 1999

SELECT a.descript 'Item Name', a.saleprice 'Sale Price'
FROM inventory a
JOIN items b
	ON a.partno = b.partno
WHERE b.orderno = '020011';



Q3. 4 Marks

Display the total amount on sales and the corresponding commission of Ted Charles (staff name)

a.	Using standard syntax

SELECT CONCAT(lastname, ', ', firstname) 'Staff Name', COUNT(*) 'Total Amount on Sales', SUM(commission) 'Commission'
FROM staff a, sales b
WHERE a.staffno = b.staffno
AND a.lastname = 'Charles';


b.	Using syntax 1999

SELECT CONCAT(lastname, ', ', firstname) 'Staff Name', COUNT(*) 'Total Amount on Sales', SUM(commission) 'Commission'
FROM staff a
JOIN sales b
	ON a.staffno = b.staffno
WHERE a.lastname = 'Charles';



Q4.  4 Marks

In the table Inventory the items that are discontinued appear under the field name DISCONTINUE with a value of 1. Write a query to find out the Customer number of those customers that have ordered items that have been discontinued.

a)	Use standard syntax

SELECT s.custno 'Customer Number' 
FROM sales s, items i, inventory c
WHERE s.orderno = i.orderno 
AND i.partno = c.partno
AND discontinue = 1;


b)	Use syntax 1999

SELECT s.custno 'Customer Number' 
FROM sales s
JOIN items i
	ON s.orderno = i.orderno
JOIN inventory c
	ON i.partno = c.partno
WHERE discontinue = 1;



Q5.  4 Marks

Find all sales done in September. Display order number, sales date and staff member name. 

a)	Use standard syntax

SELECT a.OrderNo 'Order Number', a.SaleDate 'Sales Date', CONCAT(b.Lastname,', ',b.Firstname) 'Staff Member Name'
FROM sales a, staff b
WHERE a.StaffNo = b.StaffNo
AND MONTH(SaleDate) = 9;


b)	Use syntax 1999

SELECT a.OrderNo 'Order Number', a.SaleDate 'Sales Date', CONCAT(b.Lastname,', ',b.Firstname) 'Staff Member Name'
FROM sales a 
JOIN staff b
	ON a.StaffNo = b.StaffNo
WHERE MONTH(SaleDate) = 9;



Q6.  4 Marks

Display the number of sales made by Roddick (staff last name).

a)	Use standard syntax

SELECT a.LastName 'Staff Last Name', COUNT(SaleDate) '# of Sales Made'
FROM staff a, sales b
WHERE a.StaffNo = b.StaffNo
AND Lastname = 'Roddick';


b)	Use syntax 1999

SELECT a.LastName 'Staff Last Name', COUNT(SaleDate) '# of Sales Made'
FROM staff a 
JOIN sales b
	ON a.StaffNo = b.StaffNo
WHERE Lastname = 'Roddick';



Q7.  4 Marks

Create a query to calculate all purchases of customer number 100019. The output of this query should be order number, part number, part description, quantity, sale price, and total amount per Item (Format the result to currency and two decimal places). 

a)	Use standard syntax

SELECT c.OrderNo 'Order #', a.PartNo 'Part #', a.Descript 'Description', c.Qty 'Quantity', a.SalePrice 'Sale Price', CONCAT('$',c.Qty*a.SalePrice) 'Total Amount per Item'
FROM inventory a, sales b, items c
WHERE a.PartNo = c.PartNo
AND b.OrderNo = c.OrderNo
AND b.CustNo = 100019;


b)	Use syntax 1999

SELECT c.OrderNo 'Order #', a.PartNo 'Part #', a.Descript 'Description', c.Qty 'Quantity', a.SalePrice 'Sale Price', CONCAT('$',c.Qty*a.SalePrice) 'Total Amount per Item'
FROM inventory a
JOIN items c
	ON a.PartNo = c.PartNo
JOIN sales b
	ON b.OrderNo = c.OrderNo
WHERE b.CustNo = 100019;


Q8.  4 Marks

Display the total amount in sales made by Vidoni (staff last name)
Format the result to currency and two decimal places.

a)	Use standard syntax

SELECT CONCAT('$', SUM(c.Qty*d.SalePrice)) 'Total Amount in Sales'
FROM staff a, sales b, items c, inventory d
WHERE a.StaffNo = b.StaffNo
AND b.OrderNo = c.OrderNo
AND c.PartNo = d.PartNo
AND a.Lastname = 'Vidoni';


b)	Use syntax 1999

SELECT CONCAT('$', SUM(c.Qty*d.SalePrice)) 'Total Amount in Sales'
FROM staff a
JOIN sales b
	ON a.StaffNo = b.StaffNo
JOIN items c
	ON b.OrderNo = c.OrderNo
JOIN inventory d
	ON c.PartNo = d.PartNo
WHERE a.Lastname = 'Vidoni';


Q9.  3 Marks

Display the names of employees supervised by Zambini.

a.	Using syntax 1999

SELECT CONCAT(b.LastName,', ', b.Firstname) 'Employees Supervised by Zambini' 
FROM staff a, staff b
WHERE a.Staffno = b.SupervisorNo
AND b.SupervisorNo = 000001;